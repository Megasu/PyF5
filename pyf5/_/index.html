<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>F5</title>
    <link href="/_/css/bootstrap.min.css" rel="stylesheet">
    <link href="/_/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="/_/css/index.less" type="text/css" rel="stylesheet/less">
    <script src="/_/js/libs/less.js"></script>
    <script src="/_/js/libs/jquery-1.8.2.min.js"></script>
    <script src="/_/js/libs/jquery.cookie.js"></script>
    <script src="/_/js/libs/knockout-2.2.1.js"></script>
    <script src="/_/js/libs/bootstrap.min.js"></script>
</head>
<body>

<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a href="/_" class="brand">F5</a>

            <ul class="nav pull-right">
                <li id="hosts">
                    <span>本机IP：</span>
                    <select  data-bind="foreach: $root.localHosts">
                        <option data-bind="text:$data"></option>
                    </select>
                </li>
            </ul>
        </div>
    </div>
</div>

<div id="body" class="container">
    <div class="row">

        <div class="span4">
            <h3>项目列表</h3>

            <form id="project-add-form" data-bind="submit: onSubmitProjectPath">
                <div class="input-append">
                    <input class="span3" id="new-path-input"
                           type="text" placeholder="请输入项目所在目录...">
                    <button id="project-add-btn" class="btn btn-success" type="submit">添加</button>
                </div>
            </form>

            <table id="projects" class="table table-hover">
                <tbody data-bind="foreach:projects">
                    <tr class="project" data-bind="css:{selected: $parent.currentProject() == $data}">
                        <td class="path">
                            <a href="javascript:" data-bind="text:path, click:$parent.selectProject"></a>
                        </td>
                        <td class="op">
                            <a href="javascript:" title="从列表中去除"
                               data-toggle="tooltip" data-bind="click:$root.askRemoveProject">
                                <i class="icon-trash"></i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>

        </div>

        <div id="right-panel" class="span8" data-bind="with:currentProject">

            <a id="script-hint-link" class="btn btn-small pull-right"
               data-toggle="tooltip" title="设置域名映射" data-placement="left"
               href="javascript:"
               data-bind="style:{visibility: $root.showSettings() ? 'hidden' : 'visible'},
               click: function(data, event) { $root.showSettings(true); }">
                <i class="icon-cog"></i>
            </a>

            <!-- ko if: targetHost -->
            <a id="target-host" class="label label-info pull-right" href="/" target="_blank">
                <span>映射到</span>
                <i class="icon-arrow-right icon-white"></i>
                <span data-bind="text:targetHost"></span>
            </a>
            <!-- /ko -->

            <h3>文件列表</h3>

            <form id="script-hint" class="alert alert-info" style="display:none"
                  data-bind="submit:$root.submitTargetHost, style:{display: $root.showSettings() ? 'block' : 'none'}">
                <a href="javascript:" class="close" data-bind="click: function(data,event){ $root.showSettings(false); }">&times;</a>
                <p>
                    如果是<b>静态</b>网站，请直接点击下方文件列表中的html文件来进行实时预览
                </p>
                <p>
                    如果是<b>动态</b>网站，请设定域名和端口映射，设定完成之后，访问<span data-bind="text:$root.hostText"></span>就相当于访问映射的网站（F5会帮您加上自刷新功能）
                    <div class="input-append">
                        <input class="span3" type="text" id="target-host-input"
                               placeholder="somedomain.com:8080" data-bind="attr:{value:targetHost}">
                        <button class="btn" type="submit">保存</button>
                        <button class="btn" type="button" data-bind="click:$root.clearTargetHost">清除</button>
                    </div>
                    <br>或者也可以在网页的&lt;/body&gt;之前插入下面这段代码:
                    <br>&lt;script src="http://<span data-bind="text:$root.hostText"></span>/_/js/reloader.js"&gt;&lt;/script&gt;
                </p>

            </form>

            <ul class="breadcrumb">
                <li>
                    <a href="javascript:"
                       data-bind="text:path, click:$root.clickFolderSegment"></a>
                </li>
                <!-- ko foreach: $root.folderSegments -->
                <li>
                    <span class="divider">/</span>
                    <a href="javascript:"
                       data-bind="text: $data.name(), click:$root.clickFolderSegment"></a>
                </li>
                <!-- /ko -->
            </ul>

            <table id="file-list" class="table table-hover">
                <tbody data-bind="foreach:$root.files">
                    <tr data-bind="css:{mute:isMute}">
                        <td class="file">
                            <a href="javascript:" class="icon" target="_blank"
                               data-bind="text:name, css:type, click:$root.clickFile, attr:{href:url}"></a>
                        </td>
                        <td class="span1 op">
                            <a href="javascript:" class="op mute" data-toggle="tooltip" title="停止监听更新"
                               data-bind="click:$root.toggleMute">
                                <i class="icon-ban-circle"></i>
                            </a>
                            <a href="javascript:" class="op unmute" data-toggle="tooltip" title="恢复监听更新"
                               data-bind="click:$root.toggleMute">
                                <i class="icon-ok-circle"></i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="/_/js/api.js"></script>
<script src="/_/js/index.js"></script>
</body>
</html>